@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix ff: <https://foerderfunke.org/default#> .

#################################################################
#    METADATA
#################################################################

ff:B100019_LB_581863 a ff:FundingProgram ;
    rdfs:label "Kinderzuschlag" . 

#################################################################
#    CONSTRAINTS
#################################################################

ff:KinderzuschlagShape a sh:NodeShape ;
    ff:checksFundingRequirement ff:B100019_LB_581863 ;
    sh:targetNode ff:User ;
    # 1) Must have at least one child that fulfills certain criteria
    sh:property [
        sh:path ff:hasChild ;
        sh:qualifiedValueShape ff:ChildShape ;
        sh:qualifiedMinCount 1 ;
        sh:message "Sie müssen mindestens ein Kind haben, das jünger als 25 Jahre alt ist, nicht verheiratet oder verpartnert ist, in Ihrem Haushalt lebt und Kindergeld empfängt"@de ;
    ] ;
    sh:or (
        ff:IncomeShapeA
        ff:IncomeShapeB
    ) .

# 2) Child must be younger than 25 years, not married or in a registered partnership and live in the same household as the user
ff:ChildShape a sh:NodeShape ;
    sh:property [
        sh:path ff:hasAge ;
        sh:minCount 1 ;
        sh:maxExclusive 25 ;
    ] ;
    sh:not [
		a sh:PropertyShape ;
		sh:path ff:hasMaritalStatus ;
        sh:in (ff:married ff:registeredPartnership) ;
	] ;
    sh:property [
        sh:path ff:sameHouseholdAs ;
        sh:minCount 1 ;
        sh:hasValue ff:User ;
    ] ;
    sh:property [
        sh:path ff:receivesChildBenefit ;
        sh:minCount 1 ;
        sh:minInclusive 1 ;
    ] .

# 3) As a couple, shared gross income must be at least 900€/Month
ff:IncomeShapeA a sh:NodeShape ;
    sh:property [
        sh:path ff:isSingleParent ;
        sh:minCount 1 ;
        sh:hasValue false ;
    ] ;
    sh:property [
        sh:path ff:hasGrossIncome ;
        sh:minCount 1 ;
        sh:minInclusive 900 ;
    ] .

# 4) As a single parent, gross income must be at least 600€/Month
ff:IncomeShapeB a sh:NodeShape ;
    sh:property [
        sh:path ff:isSingleParent ;
        sh:minCount 1 ;
        sh:hasValue true ;
    ] ;
    sh:property [
        sh:path ff:hasGrossIncome ;
        sh:minCount 1 ;
        sh:minInclusive 600 ;
    ] .

# 5) User income that will be offset against child supplement may not reduce child supplement to zero
# 6) User may not have considerable assets. 
# 7) Typically, user is eligible if their income, child benefit, housing benefit, and child supplement can cover the household needs according to SGB II.
# 8) Other benefits have priority over child supplement.
ff:InformationShape a sh:PropertyShape ;
    sh:path ff:NonExistentPath ;
    sh:minCount 1 ;
    sh:severity sh:Info ;
    sh:message "Zusätzlich zu beachten: Ihr anzurechnendes Einkommen darf den Kinderzuschlag nicht auf null reduzieren. Sie dürfen über kein erhebliches Vermögen verfügen. In der Regel sind Sie berechtigt, wenn Sie mi Einkommen, Kindergeld, Wohngeld und Kinderzuschlag, den Bedarf der Familie nach SGB II decken. Kinderzuschlag ist nachrangig gegenüber anderen Ansprüchen des Kindes wie Unterhalt." .