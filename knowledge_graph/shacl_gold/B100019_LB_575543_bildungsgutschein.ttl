@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix dc: <http://purl.org/dc/elements/1.1/> .
@prefix ff: <https://foerderfunke.org/default#> .

#################################################################
#    METADATA
#################################################################

ff:Bildungsgutschein a ff:FundingProgram ;
    ff:idlb "B100019.LB.575543" ;
    dc:title "Bildungsgutschein beantragen"@de ;
    dc:description "Wenn Sie arbeitslos sind und sich weiterbilden möchten, können Sie unter bestimmten Voraussetzungen einen Bildungsgutschein bekommen. Mit einem Bildungsgutschein kann die Bundesagentur für Arbeit die Kosten Ihrer beruflichen Weiterbildung übernehmen. Bevor Sie einen Bildungsgutschein bekommen, prüft die Arbeitsagentur mit Ihnen gemeinsam, ob eine Weiterbildung für Sie notwendig ist. Einen Rechtsanspruch auf einen Bildungsgutschein haben Sie nicht. Sie können den Bildungsgutschein bei einer Bildungseinrichtung Ihrer Wahl einlösen, wenn sie für die Weiterbildungsförderung zugelassen ist. Auch die Weiterbildungsmaßnahme selbst muss zugelassen sein und zum Bildungsgutschein passen. Der Bildungsgutschein legt unter anderem fest:  das Bildungsziel, die Dauer bis zum Erreichen des Bildungsziels, die Inhalte der Qualifizierung, den regionalen Geltungsbereich und die Gültigkeitsdauer, in der der Bildungsgutschein eingelöst werden und die Teilnahme begonnen haben muss.  Der Bildungsgutschein gilt grundsätzlich an Ihrem Wohnort und an Orten, die Sie täglich von zu Hause aus erreichen können. Die Agentur für Arbeit kann auch die nötigen Fahrkosten übernehmen. Wenn Ihre Arbeitslosigkeit auch ohne Weiterbildung beendet werden kann oder es andere, besser geeignete Instrumente gibt, wird Ihnen Ihre Arbeitsagentur andere Möglichkeiten vorschlagen. Wenn Ihnen die Agentur für Arbeit während des Kurses Vermitt-lungsangebote macht, müssen Sie diese wahrnehmen, auch wenn Sie eine Weiterbildung absolvieren. Auch wenn Sie Anspruch auf Arbeitslosengeld II haben, können Sie auch nach einem Bildungsgutschein fragen. Ansprechpartner ist dann das Jobcenter. Ein Rechtsanspruch darauf besteht jedoch nicht."@de . 

#################################################################
# CONSTRAINTS
#################################################################

ff:BildungsgutscheinShape a sh:NodeShape;
    ff:checksFundingProgram ff:Bildungsgutschein ;
    sh:targetClass ff:User ;
    sh:property ff:WorkExperienceProperty ; # Declare property shapes explicitly
    sh:property ff:ConsultationProperty ;
    sh:property ff:NecessityProperty ;
    sh:property ff:EducationalProgramProperty ;
    sh:property ff:SelfEffortProperty .

# User must have worked for at least three years
ff:WorkExperienceProperty a sh:PropertyShape ;
    sh:path ff:workExperience ;
    sh:minCount 1 ;
    sh:minInclusive 3 ;
    sh:message "Sie müssen mindestens drei Jahre berufstätig gewesen sein."@de .# Messages in German

# User must have consulted employment agency
ff:ConsultationProperty a sh:PropertyShape ;
    sh:path ff:hasConsulted ;
    sh:minCount 1 ;
    sh:hasValue ff:EmploymentAgency ;
    sh:message "Sie müssen an einer Beratung durch die Agentur für Arbeit teilgenomme haben"@de .

# Education must be necessary to end or avoid unemployment
ff:NecessityProperty a sh:PropertyShape ;
    sh:path ff:needsEducationFor ;
    sh:minCount 1 ;
    sh:in (ff:EndUnemployment ff:AvoidUnemployment) ;
    sh:severity sh:Warning ;
    sh:message "Die Weiterbildung muss notwendig sein, um Ihre Arbeitslosigkeit zu beenden oder eine drohende Arbeitslosigkeit abzuwenden"@de .

ff:EducationProgramProperty a sh:PropertyShape ;
    sh:path ff:selectedEducationProgram ;
    sh:qualifiedValueShape ff:EducationProgramShape ;
    sh:qualifiedMinCount 1 ;
    sh:severity sh:Warning ;
    sh:message "Die Bildungsmaßnahme und der Bildungsträger müssen zugelassen sein und sie muss im Gespräch mit der Arbeitsagentur als die 'am besten geeignete Maßname' festgelegt worden sein."@de .

ff:EducationProgramShape a sh:NodeShape ;
    # Education must be declared "most suitable measure" in consultation with employment agency
    sh:property [
        sh:path ff:mostSuitableMeasure ;
        sh:minCount 1 ;
        sh:hasValue true ;
    ] ;
    # Education must be approved
    sh:property [
        sh:path ff:isApproved ;
        sh:minCount 1 ;
        sh:hasValue true ;
    ] ;
    # Education provider must be approved
    sh:property [
        sh:path (ff:hasProvider ff:isApproved) ;
        sh:minCount 1 ;
        sh:hasValue true ;
    ] .

# User must have tried to end unemployment with "considerable effort" by themselves
ff:SelfEffortProperty a sh:PropertyShape ;
    sh:path ff:triedToEndUnemployment;
    sh:minCount 1 ;
    sh:hasValue true ;
    sh:severity sh:Warning ;
    sh:message "Sie müssen in 'erheblichem Umfang' selbst versucht haben, Ihre Arbeitslosigkeit zu beenden."@de .